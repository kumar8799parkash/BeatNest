<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sign up - BeatNest</title>
    <link rel="stylesheet" href="../css/signUpPage.css">

</head>

<body>
    <div class="signUp-main-cont">
        <div class="signUp-logo-cont">
            <img class="signUp-logo-image" src="../images/logo.png" alt="">
        </div>
        <div class="signUp-text-cont">Sign up to start listening</div>
        <div class="signUp-email-cont">
            <div class="signUp-email-heading">Email address :</div>
            <div class="signUp-email-input-cont">
                <input class="signUp-email-input" id="signUp-email-input" type="text" placeholder="name@domain.com" autofocus>
            </div>
        </div>


        <div class="signUp-password-cont">
            <div class="signUp-password-heading">password :</div>
            <div class="signUp-password-input-cont">
                <input class="signUp-password-input" id="signUp-password-input" type="text" placeholder="enter password" autofocus>
            </div>
        </div>

        <div class="signUp-button" id="signUp-button" >Next</div>
        <div class="message-cont" id="message-cont"></div>
        <div class="main-or-cont">or</div>
        <div class="googleSignUp-button-cont" id="googleSignUp-button-cont">
            <div class="googleSignUp-image-cont"><img class="googleSignUp-image" src="../svgs/google.svg" alt=""></div>
            <div class="googleSignUp-text-cont" >Sign in with Google</div>
        </div>
        <div class="appleSignUp-button-cont" id="appleSignUp-button-cont">
            <div class="appleSignUp-image-cont"><img class="appleSignUp-image" src="../svgs/apple.svg" alt=""></div>
            <div class="appleSignUp-text-cont">Sign in with Apple</div>
        </div>

        <div class="line"></div>

        <div class="logIn-option">Already have an account? <span> <a href="../html/loginPage.html">Log in here</a> </span></div>
    </div>
    <script src="../scripts/signUpPage.js"></script>

    <script>

        const signUpEmailInput = document.getElementById('signUp-email-input');
        const signUppasswordInput = document.getElementById('signUp-password-input');
        const signUpButton = document.getElementById('signUp-button');
        const messageCont = document.getElementById('message-cont');

        signUpButton.addEventListener('click' , async ()=>{
            const email = signUpEmailInput.value.trim();
            const password = signUppasswordInput.value.trim();

            if(!email || !password){
                messageCont.style.color = "red";
                messageCont.textContent = "Enter email and password both!"
                return;
            }

            try{
                const res = await fetch("http://localhost:5000/signup" , {
                    method : "POST",
                    headers : {"Content-type" : "application/json"},
                    body: JSON.stringify({email , password})
                });

                const data = await res.json();

                if(res.ok){
                    messageCont.style.color = "green";
                    messageCont.textContent = "Sign up successful! Redirecting...";

                    localStorage.setItem('beatNestToken' , data.token);

                    setTimeout(()=>{
                        window.location.href = "../mainPage.html"
                    }, 1500)

                }else{
                    messageCont.style.color = "red";
                    messageCont.textContent = data.msg || "Signup failed";
                }

            }catch(err){
                console.error("Error:" ,err);
                messageCont.style.color = "red";
                messageCont.textContent = "Server error, Please try again later!";
            }
        })


    </script>
</body>

</html>